# Design Tokens

Phase 2 migrated the design-token source of truth into `@designgreat/lib-web-ui-design-token`. The
package owns the Style Dictionary pipeline, generated runtime artifacts, and the helper utilities
that downstream apps consume (either directly or via `@designgreat/design-token-support`).

> Looking for build commands or quality-gate steps? See
> [`packages/lib-web-ui-design-token/README.md`](/packages/lib-web-ui-design-token/README.md).

## Token Authoring Structure

Tokens live under `packages/lib-web-ui-design-token/src/tokens` and are grouped by domain instead of
theme folders:

```
src/tokens/
├── color/           # Accent palettes, semantic aliases, brand mappings
├── typography/      # Font families, typography utilities, text helpers
├── shadow/          # Box & text shadow tokens
├── spacing/         # Spacing scale
├── transition/      # Motion tokens (durations, easings, gradients)
└── …                # Additional product semantics (borders, radii, etc.)
```

Every module exports plain objects. References between tokens use Style Dictionary placeholders
(e.g. `{color.accent.blue.DEFAULT}`), and authoring files can include build-time metadata such as
gradient configs or alpha overrides.

## Build Outputs

Running `pnpm --filter @designgreat/lib-web-ui-design-token build:tokens` emits:

- `dist/jsts/{light,dark}/variables.js` – ESM bundles with full token metadata.
- `dist/jsts/{light,dark}/font-face.js` – Generated font-face payloads based on typography tokens.
- `dist/css/{theme}/variables.{css,scss}` plus `font-face.css` – CSS consumables keyed by theme.
- `dist/assets/fonts/` – Downloaded Roboto assets (best-effort; empty when offline).
- `src/generated/themes.ts` – Flattened light/dark objects that power the TypeScript runtime.
- `dist/tokens/` – Snapshot of the authoring source for inspection or distribution.

The Style Dictionary build first attempts to download Roboto web fonts. When network access is
unavailable the step logs a warning and proceeds.

## Runtime APIs

The TypeScript runtime exposes strongly typed helpers for listing themes, cloning overrides, and
performing integrity checks.

```ts
import {
  DEFAULT_THEME,
  themes,
  getThemeTokens,
  createTheme,
  listThemeNames
} from '@designgreat/lib-web-ui-design-token'

// Enumerate available themes
const ids = listThemeNames()

// Access flattened token payloads
const lightTheme = getThemeTokens('light')
const background = lightTheme.color.background.DEFAULT

// Deep-merge overrides into an existing theme
const highContrast = createTheme(DEFAULT_THEME, {
  color: { background: { DEFAULT: '#F5F5F5' } }
})

console.log(ids, background, highContrast.color.background.DEFAULT)
```

Complementary helpers for CSS-variable generation live in `@designgreat/design-token-support`.

```ts
import {
  createThemeConfig,
  createCssVariableMap,
  createThemeStyles
} from '@designgreat/design-token-support'

const lightConfig = createThemeConfig('light')
const cssVars = createCssVariableMap(lightConfig.tokens)
const stylesheet = createThemeStyles('light')

console.log(lightConfig.className) // "dg-theme-light"
console.log(cssVars['--dg-color-background-default'])
console.log(stylesheet.slice(0, 60))
```

## CSS & Tailwind Integration

### Native CSS variables

Include the generated theme bundle and apply the matching theme class (generated by
`createThemeConfig`):

```css
@import '@designgreat/lib-web-ui-design-token/dist/css/light/variables.css';

body {
  background: var(--dg-color-background-default);
  color: var(--dg-color-text-default);
}

<body class="dg-theme-light">…</body>
```

When the Roboto download succeeds, the CSS bundle automatically embeds the required `@font-face`
rules.

### Tailwind CSS v4

Tailwind v4 favours authoring theme data in CSS. Generate a theme layer with the helpers and import
it alongside the Tailwind entry point:

```ts
// scripts/generate-tailwind-theme.ts
import { createThemeStyles, getThemeClassName } from '@designgreat/design-token-support'
import { writeFileSync } from 'node:fs'

const rootCss = createThemeStyles('light', { selector: ':root', indent: 2 })
const darkCss = createThemeStyles('dark', {
  selector: `.${getThemeClassName('dark')}`,
  indent: 2
})

writeFileSync('src/styles/designgreat-theme.css', `@layer theme {\n${rootCss}\n\n${darkCss}\n}\n`)
```

```css
/* src/styles/tailwind.css */
@import 'tailwindcss';
@import './designgreat-theme.css';

@custom-variant theme-dark (&:where(.dg-theme-dark &));
```

With the CSS layer in place, utilities such as `bg-[var(--dg-color-background-default)]` map
directly to token values. The helper package continues to offer `createCssVariableMap`,
`getThemeClassName`, and related utilities for JS-driven theming or SSR workflows.
