---
sidebar_position: 3
description: Storybook development workflow and best practices
---

# Storybook Workflow

This guide captures the end-to-end workflow for developing and debugging Storybook stories in the component library.

## Prerequisites

- Install dependencies from the repo root: `pnpm install`
- Ensure `@designgreat/lib-design-token` is built (Storybook imports tokens directly)
- Use a recent Node LTS release to avoid Vite/Storybook warnings

## Running Storybook During Development

```bash
pnpm --filter @designgreat/lib-web-component storybook
```

Storybook starts on `http://localhost:6006`. Use the **Theme** toolbar toggle (sun/moon icon) to switch between light and dark palettes. Stories render with `.dg-theme-dark` class applied for dark theme (light theme is the default with no class), so Tailwind token utilities update instantly when the theme changes.

### Hot Reload Expectations

- Edits to stories, components, or tokens hot reload in place
- If Tailwind classes don't appear, confirm the file path is covered by the Tailwind `content` globs (see `tailwind.config.ts`)

## Shared Demo/Code Toggle

Every interactive story should use the shared toggle from `src/storybook/CodeDemoToggle.tsx`:

```tsx
import { withCodeDemo } from '../../storybook/CodeDemoToggle'

const CODE_SNIPPETS = {
  primary: `import { Button } from '@designgreat/lib-web-component'

export function PrimaryCTA() {
  return <Button variant="primary">CTA Button</Button>
}`
} as const

const renderWithCodeToggle = (code: string) =>
  withCodeDemo<ButtonProps>({
    code,
    render: (args) => <Button {...args} />
  })

export const Primary: Story = {
  render: renderWithCodeToggle(CODE_SNIPPETS.primary),
  parameters: buildDocsParameters(CODE_SNIPPETS.primary)
}
```

### Snippet Requirements

1. Keep snippets short (show only the props needed for that story)
2. Reflect the rendered state exactly—if args change, update the snippet and Docs tab parameters
3. Declare snippets as template literals in the story file so linting and copy-to-clipboard work
4. The `CodeDemoToggle` enforces copy-to-clipboard behavior and a scrollable panel

## Story Authoring Checklist

- **Args & Controls:** Provide sensible defaults via `args` so Storybook's Controls panel can tweak props. Use `argTypes` to restrict lists (radio/inline-radio) for enums
- **Docs Tab:** Use a helper such as `buildDocsParameters` to point Docs at the same snippet string used by the toggle. Keep descriptions concise and outcome-oriented
- **Accessibility:** Prefer real interactive elements (buttons, inputs) over plain `<div>`s. When a story relies on keyboard/ARIA interactions, mirror the scenario in RTL tests
- **Variations:** Group similar stories into their component folder. If you add a new component or story tree, export it from `src/components/index.ts` so consumers can replicate the example

## Tailwind Token Utilities

- Use the generated token-driven classes (`bg-color-*`, `px-spacing-*`, etc.)
- Tailwind is configured to scan both source and Storybook files, so classes referenced only in stories are still emitted
- If you introduce an entirely new story directory, update the Tailwind `content` globs

## Linting, Tests, and QA

```bash
# Lint JSX, Storybook, and accessibility issues
pnpm --filter @designgreat/lib-web-component lint

# Optional snapshot/interaction tests
pnpm --filter @designgreat/lib-web-component storybook test --watch
```

Components should rely on Jest + React Testing Library for behavioral coverage; Storybook is for documentation and visual QA.

## Building Storybook

```bash
pnpm --filter @designgreat/lib-web-component storybook:build
```

Artifacts land in `storybook-static/` and can be uploaded to QA hosts (Netlify, Pages, etc.). Run this before handoffs to product/design teams.

## Storybook Build Output

The `storybook:build` script generates a static site in `storybook-static/` with:

- Bundled component stories
- Design tokens imported from `@designgreat/lib-design-token`
- Theme switching functionality
- Full component documentation

**Deployment:** The static site can be deployed to any static hosting service (GitHub Pages, Netlify, Vercel, etc.).

## Troubleshooting

- **Theme desync:** If toggling light/dark does nothing, ensure the preview iframe body has `.dg-theme-dark` class when dark theme is selected (light theme has no class). Re-running the dev server typically fixes it
- **Token mismatch:** Rebuild the design token package (`pnpm --filter @designgreat/lib-design-token build`) or clear `node_modules/.cache` if Tailwind refuses to emit a new token class
- **Story fails to load:** Check the browser console for async import errors—Storybook surfaces stack traces pointing to the offending story file

## Next Steps

- Review [Architecture](./architecture) to understand the build pipeline
- Check [Troubleshooting](./troubleshooting) for more common issues
- See [Get Started](./get-started) for setup instructions

